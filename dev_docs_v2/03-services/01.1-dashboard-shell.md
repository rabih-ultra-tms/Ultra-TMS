# Service 01.1: Dashboard Shell

> **Grade:** C+ (7/10) | **Priority:** Enhance | **Phase:** 0
> **Web Prompt:** `dev_docs/11-ai-dev/web-dev-prompts/01.1-dashboard-shell-ui.md`
> **Design Specs:** `dev_docs/12-Rabih-design-Process/01.1-dashboard-shell/` (6 files)

---

## Status Summary

Dashboard Shell is a production-ready layout wrapper providing the main application container (sidebar, header, user menu) for all authenticated pages. Responsive mobile/desktop support, sidebar collapse toggle, theme switching, and role-based navigation all work. Quality is 7/10 with minor issues: notification dropdown is a stub, 5 sidebar links go to 404 pages, and console.log exposes user roles.

---

## Screens

| Screen | Route | Status | Quality | Task ID | Notes |
|--------|-------|--------|---------|---------|-------|
| Dashboard Layout | `(dashboard)/layout.tsx` | Built | 7/10 | — | Server-side auth check, redirect to /login |
| Main Dashboard | `(dashboard)/page.tsx` | Built (broken) | 3/10 | BUG-008 | KPIs hardcoded to zeros |
| Sidebar Navigation | `components/layout/app-sidebar.tsx` | Built | 7/10 | BUG-003, BUG-004 | Works but 5 links 404 + console.log |
| Top Header Bar | `components/layout/app-header.tsx` | Built | 7/10 | — | Notification dropdown is stub |
| User Menu | `components/layout/user-nav.tsx` | Built | 8/10 | — | Theme switcher works |

---

## Backend API

| Endpoint | Method | Status | Notes |
|----------|--------|--------|-------|
| `GET /api/v1/auth/me` | GET | Production | Current user (used by UserNav) |
| `POST /api/v1/auth/logout` | POST | Production | Clears cookie, redirects |
| `GET /api/v1/dashboard/metrics` | GET | Not wired | KPIs — hardcoded to zeros on frontend |

---

## Frontend Components

| Component | Path | Quality | Notes |
|-----------|------|---------|-------|
| DashboardShell | `components/layout/dashboard-shell.tsx` | Good | Main wrapper |
| AppSidebar | `components/layout/app-sidebar.tsx` | Good | Desktop + mobile, collapsible |
| AppHeader | `components/layout/app-header.tsx` | Good | Notification stub |
| SidebarNav | `components/layout/sidebar-nav.tsx` | Good | Recursive nav, active states |
| UserNav | `components/layout/user-nav.tsx` | Good | Avatar, theme, logout |
| UIStore | `lib/stores/ui-store.ts` | Good | Zustand: sidebarOpen, collapsed |

---

## Design Specs

| Screen | Spec File | Content Level |
|--------|-----------|---------------|
| Dashboard Layout | `00-service-overview.md` | Overview |
| Main Dashboard | `01-main-dashboard.md` | Full 15-section |
| Sidebar Navigation | `02-sidebar-navigation.md` | Full 15-section |
| Header Bar | `03-header-bar.md` | Full 15-section |
| Notification Center | `04-notification-center.md` | Full 15-section |
| Command Palette | `05-command-palette.md` | Full 15-section |

---

## Open Bugs

| Bug ID | Title | Severity | File |
|--------|-------|----------|------|
| BUG-003 | 5 sidebar links to 404 pages | P0 | `lib/config/navigation.ts` |
| BUG-004 | User roles logged to console | P1 Security | `app-sidebar.tsx:28` |
| BUG-008 | Dashboard KPIs hardcoded to zeros | P1 UX | Dashboard page |

---

## Tasks

| Task ID | Title | Phase | Status | Effort |
|---------|-------|-------|--------|--------|
| BUG-003 | Fix sidebar 404 links | 0 | NOT STARTED | S (1-2h) |
| BUG-004 | Remove console.log of roles | 0 | NOT STARTED | S (1h) |
| BUG-008 | Wire dashboard to real API | 0 | NOT STARTED | M (2-3h) |

---

## Key Business Rules

| Rule | Detail |
|------|--------|
| **Auth Required** | All dashboard pages require valid JWT cookie; redirect to `/login` if missing |
| **Role-Based Nav** | Sidebar shows/hides links based on user role (admin sees all, dispatcher sees ops, sales sees quotes) |
| **Theme Persistence** | Dark/light theme saved to localStorage, applied via `next-themes` |
| **Sidebar State** | Collapsed/expanded state persisted in Zustand store |

## Key References

| Document | Path | What It Contains |
|----------|------|------------------|
| Dashboard Design Spec | `dev_docs/12-Rabih-design-Process/01.1-dashboard-shell/01-main-dashboard.md` | Full dashboard layout spec |
| Sidebar Navigation Spec | `dev_docs/12-Rabih-design-Process/01.1-dashboard-shell/02-sidebar-navigation.md` | Nav structure, active states |
| Navigation Config | `apps/web/lib/config/navigation.ts` | Route definitions for sidebar links |

---

## Dependencies

- **Depends on:** Auth (user context, JWT cookies), shadcn/ui, Zustand, next-themes
- **Depended on by:** All dashboard pages (every protected page renders inside DashboardShell)

---

## What to Build Next (Ordered)

1. **Fix sidebar 404 links** (BUG-003) — Remove or disable links to unbuilt pages. 1-2h.
2. **Remove console.log** (BUG-004) — Security: stop logging user roles. 5 min.
3. **Wire dashboard KPIs** (BUG-008) — Connect to order/load/carrier counts from API. 2-3h.
4. **Build notification dropdown** — Replace stub with real notification list. Future.
5. **Build command palette** (Cmd+K) — Global search using cmdk library. Future.
