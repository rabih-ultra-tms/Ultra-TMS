{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "12246ace",
   "metadata": {
    "vscode": {
     "languageId": "typescript"
    }
   },
   "outputs": [],
   "source": [
    "import * as React from \"react\";\n",
    "import Link from \"next/link\";\n",
    "import { usePathname } from \"next/navigation\";\n",
    "import { cn } from \"@/lib/utils\";\n",
    "import type { NavGroup, NavItem } from \"@/lib/types/navigation\";\n",
    "import { Badge } from \"@/components/ui/badge\";\n",
    "import { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\n",
    "import { ChevronDown, ChevronRight } from \"lucide-react\";\n",
    "\n",
    "interface SidebarNavProps {\n",
    "  groups: NavGroup[];\n",
    "  collapsed?: boolean;\n",
    "  onItemClick?: () => void;\n",
    "}\n",
    "\n",
    "export function SidebarNav({ groups, collapsed = false, onItemClick }: SidebarNavProps) {\n",
    "  const pathname = usePathname();\n",
    "  // Initialize all groups as open\n",
    "  const [openGroups, setOpenGroups] = React.useState<string[]>(\n",
    "    groups.map(g => g.title).filter(Boolean)\n",
    "  );\n",
    "\n",
    "  const toggleGroup = (title: string) => {\n",
    "    setOpenGroups(prev => \n",
    "      prev.includes(title) \n",
    "        ? prev.filter(t => t !== title)\n",
    "        : [...prev, title]\n",
    "    );\n",
    "  };\n",
    "\n",
    "  const isActive = (href: string) => {\n",
    "    if (!pathname) return false;\n",
    "    if (href === \"/dashboard\") {\n",
    "      return pathname === \"/dashboard\";\n",
    "    }\n",
    "    return pathname.startsWith(href);\n",
    "  };\n",
    "\n",
    "  // Check if any child of the group is active to keep it open?\n",
    "  // Maybe unnecessary if user controls it, but good UX.\n",
    "  React.useEffect(() => {\n",
    "    if (collapsed) return;\n",
    "    // Auto-open group if item is active\n",
    "    groups.forEach(group => {\n",
    "      const hasActive = group.items.some(item => isActive(item.href));\n",
    "      if (hasActive && group.title && !openGroups.includes(group.title)) {\n",
    "        setOpenGroups(prev => [...prev, group.title]);\n",
    "      }\n",
    "    });\n",
    "  }, [pathname, collapsed, groups]); // Added groups to dependency\n",
    "\n",
    "  const renderNavItem = (item: NavItem) => {\n",
    "    const Icon = item.icon;\n",
    "    const active = isActive(item.href);\n",
    "\n",
    "    const linkContent = (\n",
    "      <Link\n",
    "        href={item.disabled ? \"#\" : item.href}\n",
    "        onClick={onItemClick}\n",
    "        className={cn(\n",
    "          \"flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors\",\n",
    "          \"hover:bg-accent hover:text-accent-foreground\",\n",
    "          active ? \"bg-accent text-accent-foreground\" : \"text-muted-foreground\",\n",
    "          item.disabled && \"pointer-events-none opacity-50\",\n",
    "          collapsed && \"justify-center px-2\"\n",
    "        )}\n",
    "      >\n",
    "        <Icon className={cn(\"h-4 w-4 shrink-0\", active && \"text-primary\")} />\n",
    "        {!collapsed && (\n",
    "          <>\n",
    "            <span className=\"flex-1 truncate\">{item.title}</span>\n",
    "            {item.badge && (\n",
    "              <Badge variant=\"secondary\" className=\"ml-auto h-5 px-1.5 text-xs\">\n",
    "                {item.badge}\n",
    "              </Badge>\n",
    "            )}\n",
    "          </>\n",
    "        )}\n",
    "      </Link>\n",
    "    );\n",
    "\n",
    "    if (collapsed) {\n",
    "      return (\n",
    "        <Tooltip key={item.href} delayDuration={0}>\n",
    "          <TooltipTrigger asChild>{linkContent}</TooltipTrigger>\n",
    "          <TooltipContent side=\"right\" className=\"flex items-center gap-2\">\n",
    "            {item.title}\n",
    "            {item.badge && (\n",
    "              <Badge variant=\"secondary\" className=\"h-5 px-1.5 text-xs\">\n",
    "                {item.badge}\n",
    "              </Badge>\n",
    "            )}\n",
    "          </TooltipContent>\n",
    "        </Tooltip>\n",
    "      );\n",
    "    }\n",
    "\n",
    "    return <React.Fragment key={item.href}>{linkContent}</React.Fragment>;\n",
    "  };\n",
    "\n",
    "  return (\n",
    "    <nav className=\"flex flex-col gap-1\">\n",
    "      {groups.map((group, groupIndex) => {\n",
    "        const isOpen = openGroups.includes(group.title) || !group.title;\n",
    "        \n",
    "        return (\n",
    "          <div key={group.title || groupIndex} className={cn(groupIndex > 0 && \"mt-4\")}> \n",
    "            {!collapsed && group.title ? (\n",
    "              <button\n",
    "                onClick={() => toggleGroup(group.title)}\n",
    "                className=\"flex w-full items-center justify-between mb-2 px-3 text-xs font-semibold uppercase tracking-wider text-muted-foreground hover:text-foreground transition-colors group\"\n",
    "              >\n",
    "                <span>{group.title}</span>\n",
    "                {isOpen ? (\n",
    "                  <ChevronDown className=\"h-3 w-3 opacity-50 group-hover:opacity-100\" />\n",
    "                ) : (\n",
    "                  <ChevronRight className=\"h-3 w-3 opacity-50 group-hover:opacity-100\" />\n",
    "                )}\n",
    "              </button>\n",
    "            ) : null}\n",
    "            \n",
    "            <div className={cn(\n",
    "              \"flex flex-col gap-1 transition-all\",\n",
    "              !isOpen && group.title && !collapsed ? \"hidden\" : \"block\"\n",
    "            )}>\n",
    "              {group.items.map(renderNavItem)}\n",
    "            </div>\n",
    "          </div>\n",
    "        );\n",
    "      })}\n",
    "    </nav>\n",
    "  );\n",
    "}"
   ]
  }
 ],
 "metadata": {
  "language_info": {
   "name": "python"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
