
import { render, screen } from "@/test/utils";
import { ListPage } from "@/components/patterns/list-page";
import { columns } from "@/app/(dashboard)/carriers/columns";
import { jest } from "@jest/globals";
import * as React from "react";

// Mock next/navigation
jest.mock("next/navigation", () => ({
    useRouter: () => ({
        push: jest.fn(),
        back: jest.fn(),
        refresh: jest.fn(),
    }),
    useSearchParams: () => ({
        get: jest.fn(),
    }),
    usePathname: () => "/carriers",
}));

const mockData: any[] = [
    {
        id: "1",
        companyName: "Test Carrier",
        status: "ACTIVE",
        carrierType: "COMPANY",
        mcNumber: "12345",
        dotNumber: "67890",
        city: "Metropolis",
        state: "NY",
        contactName: "John Doe",
        contactPhone: "555-1234",
        driverCount: 5,
        truckCount: 0,
        trailerCount: 0,
        insuranceStatus: "VALID",
        insuranceExpiryDate: "2027-01-01",
        createdAt: "2026-01-01",
        updatedAt: "2026-01-01",
    },
];

describe("Carriers List Integration", () => {
    it("renders carriers list correctly", () => {
        const setPage = jest.fn();
        const setSorting = jest.fn();
        const setRowSelection = jest.fn();

        render(
            <ListPage
                title="Carriers"
                data={mockData}
                columns={columns}
                total={1}
                page={1}
                pageCount={1}
                onPageChange={setPage}
                sorting={[]}
                onSortingChange={setSorting}
                rowSelection={{}}
                onRowSelectionChange={setRowSelection}
                entityLabel="carriers"
            />
        );

        expect(screen.getByText("Test Carrier")).toBeInTheDocument();
        expect(screen.getByText("12345")).toBeInTheDocument();
        expect(screen.getByText("Metropolis, NY")).toBeInTheDocument(); // Location cell combines them
    });
});
